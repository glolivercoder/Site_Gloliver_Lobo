import { DayPickerProps } from "DayPicker";

import { customRender } from "test/render/customRender";
import { freezeBeforeAll } from "test/utils";

import { FooterProps } from "components/Footer";

import { Table, TableProps } from "./Table";

function setup(props: TableProps, dayPickerProps?: DayPickerProps) {
  return customRender(<Table {...props} data-oid="-d.i9v7" />, dayPickerProps);
}

const today = new Date(2021, 11, 8);
freezeBeforeAll(today);

const props: TableProps = {
  displayMonth: new Date(2020, 1),
};

test("should render correctly", () => {
  const { container } = setup(props);
  expect(container.firstChild).toMatchSnapshot();
});

describe("when showing the week numbers", () => {
  const dayPickerProps = { showWeekNumber: true };
  test("should render correctly", () => {
    const { container } = setup(props, dayPickerProps);
    expect(container.firstChild).toMatchSnapshot();
  });
});

describe("when using custom components", () => {
  const dayPickerProps: DayPickerProps = {
    components: {
      Head: () => (
        <thead data-oid="ve3me.2">
          <tr data-oid=".9t7v0t">
            <td data-oid="mio3w5y">CustomHead</td>
          </tr>
        </thead>
      ),

      Row: () => (
        <tr data-oid="_7dkiup">
          <td data-oid="h9.aqw-">CustomRow</td>
        </tr>
      ),

      Footer: (props: FooterProps) => (
        <tfoot data-oid="-rz_rn-">
          <tr data-oid="zr.098e">
            <td data-oid=".sh.iq0">{props.displayMonth?.toDateString()}</td>
          </tr>
        </tfoot>
      ),
    },
  };
  test("should render correctly", () => {
    const { container } = setup(props, dayPickerProps);
    expect(container.firstChild).toMatchSnapshot();
  });
});
